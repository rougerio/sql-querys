ALTER SESSION SET NLS_DATE_FORMAT = 'dd/mm/yyyy hh24:mi:ss';


SELECT ITEM, SUM(PACKS), SUM(PACKS)/PACKSxPALLETS, PACKSxPALLETS
FROM (
        SELECT SUBSTR(PIT.DESCRIPTION, 0, LENGTH(PIT.DESCRIPTION)-3) ITEM, SUM(ORL.ITEM_PACKAGE_COUNT) PACKS, REGEXP_SUBSTR(PIT.DESCRIPTION, '[^.]+', 1,6) PACKSxPALLETS --ORE.ORDER_RELEASE_GID, ORE.SOURCE_LOCATION_GID, ORE.DEST_LOCATION_GID, ORL.PACKAGED_ITEM_GID, PIT.DESCRIPTION
        FROM ORDER_RELEASE ORE INNER JOIN
            ORDER_RELEASE_LINE ORL ON ORE.ORDER_RELEASE_GID = ORL.ORDER_RELEASE_GID INNER JOIN
            PACKAGED_ITEM PIT ON PIT.PACKAGED_ITEM_GID = ORL.PACKAGED_ITEM_GID 
        WHERE ORE.SOURCE_LOCATION_GID IN ('NBL.ORG-1592-85197','NBL.ORG-5190-216133','NBL.ORG-109-145','NBL.ORG-1942-95045','NBL.ORG-4629-193297','NBL.ORG-408-6204','NBL.ORG-2587-121829')
        AND ORE.DEST_LOCATION_GID IN ('NBL.ORG-3767-152492','NBL.ORG-5272-219663','NBL.ORG-4729-194868','NBL.ORG-4769-195887')
        AND ORE.ORDER_RELEASE_TYPE_GID = 'NBL.TRANSFER_FG'
        AND TO_CHAR(ORE.INSERT_DATE, 'DD/MM/YY') >= '01/01/24'
        GROUP BY ORL.PACKAGED_ITEM_GID, PIT.DESCRIPTION
    )
GROUP BY ITEM, PACKSxPALLETS
    ;



('ORG-3767-152492','ORG-5272-219663','ORG-4729-194868','ORG-4769-195887')


('3MZ_SHIPPING_REGION','3GD_SHIPPING_REGION','3MX_SHIPPING_REGION','3TJ_SHIPPING_REGION')

3MZ_SHIPPING_REGION,3GD_SHIPPING_REGION,3MX_SHIPPING_REGION,3TJ_SHIPPING_REGION